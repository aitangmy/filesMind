
=== Method B: Frequency-Based Header/Footer Detection ===
[FAIL] HF-B-1 Header fingerprint detected
       expected: True
       got:      False
       note: fingerprints: set()
[FAIL] HF-B-2 Footer fingerprint detected
       expected: True
       got:      False
[PASS] HF-B-3 Chapter headings NOT removed
[PASS] HF-B-4 Unique content NOT removed
[FAIL] HF-B-5 Header lines replaced with blank
       expected: True
       got:      False
[PASS] HF-B-6 Rare line NOT removed
[PASS] HF-B-7 Too few pages → no removal
       note: Need >= 3 pages for reliable detection

=== Chinese Document Simulation ===
[Method B] Detected 3 header/footer fingerprint(s) (threshold: 2/2 pages): '2026 年 5 月芝士架构公共知识红宝书（系统架构设计师公共基础知识）', '这是正文内容，描述系统架构的基本概念。', '添加微信 deckardcain4 加群'
[PASS] CN-1 Chinese header detected
[PASS] CN-2 Chinese footer detected
[PASS] CN-3 Chapter headings preserved
[FAIL] CN-4 Body text preserved
       expected: True
       got:      False

=== TOC Detection ===
[PASS] TOC-1 TOC detected
       note: start=0, end=5
[PASS] TOC-2 No TOC in normal content

=== Split Heading Merge ===
[PASS] SPLIT-1 1.3.9. merged with title
[PASS] SPLIT-2 Q2 merged with title
[PASS] SPLIT-3 Normal heading preserved

=== Q-Series Heading Level Inference ===
[PASS] Q-1 Q1 → level 2
[PASS] Q-2 Q10 → level 2
[PASS] Q-3 1.1.1 → level 3
[PASS] Q-4 2×10ns rejected
       note: math expression should fall back to markdown level

=== is_valid_heading ===
[PASS] VH-1 Normal heading valid
[PASS] VH-2 Formula rejected
[PASS] VH-3 List item rejected
[PASS] VH-4 Too long rejected

=======================================================
Results: 20/24 passed
=======================================================
Results saved to backend/test_universal_hf_results.json
